<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brief Builder – Dot Hub</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <div class="logo" onclick="showView('entry')">
                <div class="logo-mark">h</div>
                <span>DOT HUB</span>
            </div>
            <nav class="nav">
                <button class="nav-tab">Ask Dot</button>
                <button class="nav-tab">WIP</button>
                <button class="nav-tab">Tracker</button>
                <button class="nav-tab active">Brief</button>
            </nav>
        </div>
        <div class="header-right" id="headerRight" style="display: none;">
            <div class="save-status" id="saveStatus">
                <svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
                Saved
            </div>
            <button class="btn-pdf" onclick="exportPdf()">
                <svg class="icon icon-sm" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                GET PDF
            </button>
        </div>
    </header>
    
    <!-- ==================== -->
    <!-- ENTRY VIEW           -->
    <!-- ==================== -->
    <div class="view active" id="viewEntry">
        <div class="entry-view">
            <div class="entry-header">
                <div class="entry-logo">
                    <div class="entry-logo-mark">h</div>
                    <div class="entry-logo-text">BRIEF</div>
                </div>
                <p class="entry-intro">Catch all the detail and dig for insights with Dot.</p>
            </div>
            
            <div class="entry-cards">
                <div class="entry-card">
                    <div class="entry-card-title">Choose a job</div>
                    <div class="form-field">
                        <select class="form-select" id="selectClient" onchange="updateJobs()">
                            <option value="">Client</option>
                            <option value="tow">Tower Insurance</option>
                            <option value="onz">One NZ</option>
                            <option value="sky">Sky</option>
                            <option value="ff">Fisher Funds</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <select class="form-select" id="selectJob" disabled>
                            <option value="">Job</option>
                        </select>
                    </div>
                    <a class="new-job-link" onclick="openNewJobModal()">
                        <svg class="icon icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                        Set up a new job
                    </a>
                </div>
                
                <div class="entry-card">
                    <div class="entry-card-title">Add your inputs</div>
                    <div class="drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
                        <div class="drop-zone-icon">
                            <svg class="icon icon-lg" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                        </div>
                        <div class="drop-zone-text">Drop files here or <strong>click to upload</strong></div>
                        <div class="drop-zone-hint">PDF, Word, PowerPoint, images</div>
                    </div>
                    <div class="uploaded-files" id="uploadedFiles"></div>
                    <input type="file" id="fileInput" class="file-input" multiple accept=".pdf,.doc,.docx,.ppt,.pptx,.png,.jpg,.jpeg" onchange="handleFiles(event)">
                </div>
            </div>
            
            <div class="ready-box">
                <div class="ready-box-title">Ready</div>
                <div class="ready-list" id="readyList">
                    <div class="ready-empty">Select a job to get started</div>
                </div>
                <div class="ready-box-footer">
                    <button class="btn-go" id="btnGo" onclick="startBuilder()" disabled>LET'S GO</button>
                </div>
            </div>
            
            <div class="recent-section">
                <div class="recent-title">Recent briefs</div>
                <div class="recent-list" id="recentBriefsList">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- ==================== -->
    <!-- BRIEF BUILDER VIEW   -->
    <!-- ==================== -->
    <div class="view" id="viewBuilder">
        <div class="meta-bar" id="metaBar">
            <div class="meta-inner">
                <div class="meta-info">
                    <span class="meta-job" id="metaJobNumber">TOW 089</span>
                    <span class="meta-name" id="metaJobName">Brand Refresh Campaign</span>
                </div>
                <div class="meta-actions">
                    <button class="meta-btn" onclick="openMetaModal()" title="Edit details">
                        <svg class="icon icon-sm" viewBox="0 0 24 24"><path d="M17 3a2.85 2.85 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/></svg>
                    </button>
                    <button class="meta-btn" onclick="toggleMeta()" title="Collapse">
                        <svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></svg>
                    </button>
                </div>
            </div>
        </div>
        
        <button class="meta-toggle" id="metaToggle" onclick="toggleMeta()">
            <svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
            <span id="metaToggleText">TOW 089 – Brand Refresh Campaign</span>
        </button>
        
        <main class="main">
            <div class="progress">
                <div class="progress-step active" id="progressTopline" onclick="showPage('topline')">
                    <div class="progress-dot"></div>
                    TOPLINE
                </div>
                <div class="progress-line"></div>
                <div class="progress-step" id="progressThinking" onclick="showPage('thinking')">
                    <div class="progress-dot"></div>
                    THINKING
                </div>
                <div class="progress-line"></div>
                <div class="progress-step" id="progressNutshell" onclick="showPage('nutshell')">
                    <div class="progress-dot"></div>
                    NUTSHELL
                </div>
                <div class="progress-line"></div>
                <div class="progress-step" id="progressDetail" onclick="showPage('detail')">
                    <div class="progress-dot"></div>
                    DETAIL
                </div>
            </div>
            
            <div class="page active" id="pageTopline">
                <h1 class="page-title">What's the job?</h1>
                <div id="sectionsTopline"></div>
                <div class="page-nav">
                    <div></div>
                    <button class="btn-nav" onclick="showPage('thinking')">THINKING <svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg></button>
                </div>
            </div>
            
            <div class="page" id="pageThinking">
                <h1 class="page-title">Four questions. One hunch.</h1>
                <div id="sectionsThinking"></div>
                <div class="page-nav">
                    <button class="btn-nav" onclick="showPage('topline')"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg> TOPLINE</button>
                    <button class="btn-nav" onclick="showPage('nutshell')">NUTSHELL <svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg></button>
                </div>
            </div>
            
            <div class="page" id="pageNutshell">
                <h1 class="page-title">The guts of it.</h1>
                <div id="sectionsNutshell"></div>
                <div class="page-nav">
                    <button class="btn-nav" onclick="showPage('thinking')"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg> THINKING</button>
                    <button class="btn-nav" onclick="showPage('detail')">DETAIL <svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg></button>
                </div>
            </div>
            
            <div class="page" id="pageDetail">
                <h1 class="page-title">The supporting evidence.</h1>
                <div class="detail-toggles">
                    <label class="detail-toggle">
                        <input type="checkbox" id="toggleProofPoints" onchange="toggleDetailSection('proofPoints')">
                        <span class="detail-toggle-box"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></span>
                        Proof Points
                    </label>
                    <label class="detail-toggle always-on">
                        <input type="checkbox" checked disabled>
                        <span class="detail-toggle-box"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></span>
                        Mandatories
                    </label>
                    <label class="detail-toggle always-on">
                        <input type="checkbox" checked disabled>
                        <span class="detail-toggle-box"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></span>
                        Questions
                    </label>
                    <label class="detail-toggle">
                        <input type="checkbox" id="toggleResearch" onchange="toggleDetailSection('research')">
                        <span class="detail-toggle-box"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></span>
                        Research
                    </label>
                    <label class="detail-toggle">
                        <input type="checkbox" id="toggleAppendix" onchange="toggleDetailSection('appendix')">
                        <span class="detail-toggle-box"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></span>
                        Appendix
                    </label>
                </div>
                <div id="sectionsDetail"></div>
                <div class="page-nav">
                    <button class="btn-nav" onclick="showPage('nutshell')"><svg class="icon icon-sm" viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg> NUTSHELL</button>
                    <button class="btn-nav primary" onclick="exportPdf()">GET PDF <svg class="icon icon-sm" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
                </div>
            </div>
        </main>
    </div>
    
    <!-- New Job Modal -->
    <div class="modal-overlay" id="newJobModal" onclick="closeNewJobModal()">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">Set up a new job</h3>
                <button class="modal-close" onclick="closeNewJobModal()">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M18 6 6 18M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Client</label>
                <select class="form-select" id="newJobClient">
                    <option value="">Select client</option>
                    <option value="tow">Tower Insurance</option>
                    <option value="onz">One NZ</option>
                    <option value="sky">Sky</option>
                    <option value="ff">Fisher Funds</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Job Number</label>
                <input type="text" class="form-input" id="newJobNumber" placeholder="e.g. TOW 090">
            </div>
            <div class="form-group">
                <label class="form-label">Job Name</label>
                <input type="text" class="form-input" id="newJobName" placeholder="e.g. Summer Campaign">
            </div>
            <div class="form-group">
                <label class="form-label">Project Owner</label>
                <input type="text" class="form-input" id="newJobOwner" placeholder="e.g. Emma">
            </div>
            <div class="modal-footer">
                <button class="btn-done" onclick="createNewJob()">Create Job</button>
            </div>
        </div>
    </div>
    
    <!-- Meta Modal -->
    <div class="modal-overlay" id="metaModal" onclick="closeMetaModal()">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">Job Details</h3>
                <button class="modal-close" onclick="closeMetaModal()">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M18 6 6 18M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="form-group">
                <label class="form-label">Job Number</label>
                <input type="text" class="form-input" id="inputJobNumber" value="">
            </div>
            <div class="form-group">
                <label class="form-label">Job Name</label>
                <input type="text" class="form-input" id="inputJobName" value="">
            </div>
            <div class="form-group">
                <label class="form-label">Project Owner</label>
                <input type="text" class="form-input" id="inputProjectOwner" value="">
            </div>
            <div class="form-group">
                <label class="form-label">Hunch Lead</label>
                <input type="text" class="form-input" id="inputHunchLead" value="">
            </div>
            <div class="form-group">
                <label class="form-label">Date / Version</label>
                <input type="text" class="form-input" id="inputDate" value="">
            </div>
            <div class="modal-footer">
                <button class="btn-done" onclick="saveMeta()">Done</button>
            </div>
        </div>
    </div>
    
    <!-- JSON Modal (for debugging/import) -->
    <div class="modal-overlay" id="jsonModal" onclick="closeJsonModal()">
        <div class="modal modal-wide" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">Import/Export JSON</h3>
                <button class="modal-close" onclick="closeJsonModal()">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M18 6 6 18M6 6l12 12"/></svg>
                </button>
            </div>
            <textarea id="jsonInput" class="json-textarea" placeholder="Paste JSON here..."></textarea>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="copyJson()">Copy JSON</button>
                <button class="btn-done" onclick="applyJson()">Load</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
